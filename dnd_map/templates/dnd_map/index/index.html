{% extends "dnd_map/base.html" %}
{% load static %}

{% block title %}{{ world_name }} | D&D IMV{% endblock %}

{% block scripts %}
{% if is_map_set %}
<script src="{% static 'dnd_map/scripts/mapResize.js' %}"></script>
<script src="{% static 'dnd_map/scripts/generateListView.js' %}"></script>
<script>
    window.onload = function () {
        new ImageMap(document.getElementById('map'),
            document.getElementById('img'),
            parseInt('{{ map_original_width }}')).resize()

        populateListView('{{ items | safe }}', {{ user.is_authenticated|yesno:"true,false" }}, "{% url 'dnd_map:new' %}")
    }
</script>
{% endif %}
{% endblock %}

{% block body %}
{% if is_map_set %}
<div id="map_view">
    <img id="img" src="{% static map_path %}" alt="Map of the world" usemap="#map" width="100%">

    <map id="map" name="map">
        {% comment %}
        {% for place in places %}
        {% if place.index_coords %}
        <area shape="rect" coords="{{ place.index_coords }}" href="{% url 'dnd_map:places' place.city.kingdom.name place.city.name place.name %}"
              title="{{ place.name}}, {{ place.city.name }}, {{ place.city.kingdom.name }}" alt="{{ place.name}}, {{ city.name }}, {{ city.kingdom }}">
        {% endif %}
        {% endfor%}
        {% for city in cities %}
        {% if city.index_coords %}
        <area shape="rect" coords="{{ city.index_coords }}" href="{% url 'dnd_map:cities' city.kingdom.name city.name %}"
              title="{{ city.name }}, {{ city.kingdom.name }}" alt="{{ city.name }}, {{ city.kingdom.name }}">
        {% endif %}
        {% endfor%}
        {% for terrain_coord in terrain_coords %}
        <area shape="rect" coords="{{ terrain_coord.coords }}" href="{% url 'dnd_map:terrains' terrain_coord.terrain.name %}"
              title="{{ terrain_coord.terrain.name }}" alt="{{ terrain_coord.terrain.name }}">
        {% endfor%}
        {% for kingdom in kingdoms %}
        {% if kingdom.coords %}
        <area shape="rect" coords="{{ kingdom.coords }}" href="{% url 'dnd_map:kingdoms' kingdom.name %}"
              title="{{ kingdom.name }}" alt="{{ kingdom.name }}">
        {% endif %}
        {% endfor%}
        {% endcomment %}
    </map>
</div>
{% endif %}
<div id="list_view">

</div>
{% endblock %}
